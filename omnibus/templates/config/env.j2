# KodeCD Environment Configuration
# Auto-generated from /etc/kodecd/kodecd.conf

RAILS_ENV={{ rails_env }}
SECRET_KEY_BASE={{ secret_key_base }}

# Database
DATABASE_URL={{ database_url }}

# Redis
REDIS_URL={{ redis_url }}

# External URL
KODECD_EXTERNAL_URL={{ kodecd_config.external_url }}

# Storage
GIT_DATA_DIR={{ kodecd_config.git_data_dir | default('/var/opt/kodecd/git-data') }}
ARTIFACTS_DIR={{ kodecd_config.artifacts_dir | default('/var/opt/kodecd/artifacts') }}
CACHE_DIR={{ kodecd_config.cache_dir | default('/var/opt/kodecd/cache') }}

# Mail
{% if kodecd_config.mail_enabled | default(false) %}
SMTP_ADDRESS={{ kodecd_config.smtp_address }}
SMTP_PORT={{ kodecd_config.smtp_port }}
SMTP_USERNAME={{ kodecd_config.smtp_username }}
SMTP_PASSWORD={{ kodecd_config.smtp_password }}
SMTP_DOMAIN={{ kodecd_config.smtp_domain }}
SMTP_AUTHENTICATION={{ kodecd_config.smtp_authentication | default('plain') }}
SMTP_ENABLE_STARTTLS_AUTO={{ kodecd_config.smtp_enable_starttls_auto | default('true') }}
MAIL_FROM={{ kodecd_config.mail_from }}
{% endif %}

# Logging
LOG_LEVEL={{ kodecd_config.log_level | default('info') }}

# Puma
WEB_CONCURRENCY={{ kodecd_config.puma_workers | default(2) }}
RAILS_MAX_THREADS={{ kodecd_config.puma_threads_max | default(5) }}
RAILS_MIN_THREADS={{ kodecd_config.puma_threads_min | default(5) }}
